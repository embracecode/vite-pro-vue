import{bW as Y,r as x,bg as v,bX as Z,bY as w,O as G,au as z,bZ as R,a as X,aC as H,f as A,s as I,y as e,w as a,k as t,W as y,b_ as K,h as B,j as $,F as O,am as Q,g as T,t as U,v as F,a0 as ee,b$ as te,Y as ae,Z as le,$ as se,a1 as re}from"./index-DPtc5B1r.js";import{E as ne,a as oe,b as ce}from"./el-table-column-B9J-04Mz.js";/* empty css                   */const ie=()=>{let b=[];const m=Y();let l=x([]);const f=o=>{b=o},n=()=>{m.c3Id||b.length>0?m.c3Id?_():_(b):v({message:"请选择三种类别",type:"warning"})},_=o=>{if(o){const[r,p,i]=o;C(r,p,i)}else{const{c1Id:r,c2Id:p,c3Id:i}=m;C(r,p,i)}},C=async(o,r,p)=>{let i=await Z(o,r,p);i.code===200&&(l.value=i.data)};return{searchParam:f,searchData:n,deleteAttr:async o=>{(await w(o)).code===200?(v({type:"success",message:"删除成功"}),_()):v({type:"error",message:"删除失败"})},getAttr:_,categoryStore:m,attrArr:l}},de=(b,m)=>{let l=G({attrName:"",attrValueList:[],categoryId:"",categoryLevel:3}),f=x([]),n=x(0);return{attrParams:l,addAttr:()=>{Object.assign(l,{attrName:"",attrValueList:[],categoryId:b.c3Id,categoryLevel:3}),n.value=1},updateAttr:c=>{n.value=1,Object.assign(l,JSON.parse(JSON.stringify(c)))},addAttrValue:()=>{l.attrValueList.push({valueName:"",flag:!0}),z(()=>{f.value[l.attrValueList.length-1].focus()})},save:async()=>{(await R(l)).code===200?(n.value=0,v({type:"success",message:l.id?"修改成功":"添加成功"}),m()):v({type:"error",message:l.id?"修改失败":"添加失败"})},toLook:(c,k)=>{if(c.valueName.trim()===""){l.attrValueList.splice(k,1),v({type:"error",message:"属性值不能为空"});return}if(l.attrValueList.find(N=>{if(N!==c)return N.valueName===c.valueName})){l.attrValueList.splice(k,1),v({type:"error",message:"属性值不能重复"});return}c.flag=!1},toEdit:(c,k)=>{c.flag=!0,z(()=>{f.value[k].focus()})},cancel:()=>{n.value=0},inputArr:f,scene:n}},ue=["onClick"],ge=X({__name:"index",setup(b){const{searchParam:m,searchData:l,deleteAttr:f,categoryStore:n,attrArr:_,getAttr:C}=ie(),{addAttr:h,updateAttr:o,attrParams:r,inputArr:p,toLook:i,toEdit:c,addAttrValue:k,cancel:L,save:N,scene:E}=de(n,C);return H(()=>{n.$reset()}),(me,D)=>{const d=ee,g=ne,j=te,q=oe,P=ce,S=ae,J=le,M=se,W=re;return A(),I(O,null,[e(K,{scene:t(E),onSearchParam:t(m)},{default:a(()=>[e(d,{type:"primary",onClick:t(l)},{default:a(()=>[y("查询")]),_:1},8,["onClick"])]),_:1},8,["scene","onSearchParam"]),e(W,{style:{margin:"10px 0"}},{default:a(()=>[B($("div",null,[e(d,{type:"primary",size:"default",icon:"Plus",disabled:!t(n).c3Id,onClick:t(h)},{default:a(()=>[y(" 添加平台属性 ")]),_:1},8,["disabled","onClick"]),e(P,{border:"",style:{margin:"10px 0"},data:t(_)},{default:a(()=>[e(g,{label:"序号",type:"index",align:"center",width:"80px"}),e(g,{label:"属性名称",prop:"attrName"}),e(g,{label:"属性值名称"},{default:a(({row:s})=>[(A(!0),I(O,null,Q(s.attrValueList,u=>(A(),T(j,{style:{margin:"5px"},key:u.id},{default:a(()=>[y(U(u.valueName),1)]),_:2},1024))),128))]),_:1}),e(g,{label:"操作"},{default:a(({row:s})=>[e(d,{type:"primary",size:"small",icon:"Edit",onClick:u=>t(o)(s)},null,8,["onClick"]),e(q,{title:`你确定删除${s.attrName}?`,width:"200px",onConfirm:u=>t(f)(s.id)},{reference:a(()=>[e(d,{type:"danger",size:"small",icon:"Delete"})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"])],512),[[F,t(E)===0]]),B($("div",null,[e(M,{inline:!0},{default:a(()=>[e(J,{label:"属性名称"},{default:a(()=>[e(S,{placeholder:"请你输入属性名称",modelValue:t(r).attrName,"onUpdate:modelValue":D[0]||(D[0]=s=>t(r).attrName=s)},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{disabled:!t(r).attrName,type:"primary",size:"default",icon:"Plus",onClick:t(k)},{default:a(()=>[y(" 添加属性值 ")]),_:1},8,["disabled","onClick"]),e(d,{size:"default",onClick:t(L)},{default:a(()=>[y("取消")]),_:1},8,["onClick"]),e(P,{border:"",style:{margin:"10px 0"},data:t(r).attrValueList},{default:a(()=>[e(g,{label:"序号",width:"80px",type:"index",align:"center"}),e(g,{label:"属性值名称"},{default:a(({row:s,$index:u})=>[s.flag?(A(),T(S,{key:0,ref:V=>t(p)[u]=V,placeholder:"请你输入属性值名称",modelValue:s.valueName,"onUpdate:modelValue":V=>s.valueName=V,onBlur:V=>t(i)(s,u)},null,8,["modelValue","onUpdate:modelValue","onBlur"])):(A(),I("div",{key:1,onClick:V=>t(c)(s,u)},U(s.valueName),9,ue))]),_:1}),e(g,{label:"属性值操作"},{default:a(({$index:s})=>[e(d,{type:"danger",size:"small",icon:"Delete",onClick:u=>t(r).attrValueList.splice(s,1)},null,8,["onClick"])]),_:1})]),_:1},8,["data"]),e(d,{type:"primary",size:"default",onClick:t(N),disabled:!(t(r).attrValueList.length>0)},{default:a(()=>[y(" 保存 ")]),_:1},8,["onClick","disabled"]),e(d,{size:"default",onClick:t(L)},{default:a(()=>[y("取消")]),_:1},8,["onClick"])],512),[[F,t(E)===1]])]),_:1})],64)}}});export{ge as default};
